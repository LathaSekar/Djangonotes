
1Ô∏è‚É£ Model Introduction

A Model in Django represents a **database table**.

Each:

Class = Table
Attribute (field) = Column
Object = Row

üìÅ `models.py`

```python
from django.db import models

class Student(models.Model):
    name = models.CharField(max_length=100)
    email = models.EmailField()
    age = models.IntegerField()
    message=models.TextField()
    balance=models.FloatField()
    def __str__(self):
        return self.name
```

Django automatically creates SQL tables from this model.

---

# üß© 2Ô∏è‚É£ Field Types & Customization

Django provides many field types.

| Field Type    | Use              |
| ------------- | ---------------- |
| CharField     | Short text       |
| TextField     | Large text       |
| IntegerField  | Numbers          |
| FloatField    | Decimal numbers  |
| BooleanField  | True/False       |
| DateField     | Date only        |
| DateTimeField | Date + Time      |
| EmailField    | Email validation |
| FileField     | File upload      |
| ImageField    | Image upload     |

### üîπ Customizing Fields

```python
class Employee(models.Model):
    name = models.CharField(max_length=100, null=False, blank=False,Primary_key=True)
    primary key: it is a field that uniquely identifies each record in a table
    email = models.EmailField(unique=True)
    salary = models.DecimalField(max_digits=10, decimal_places=2)
    joined_date = models.DateField(auto_now_add=True)
    It records the creation timestamp and never changes again
    updated_at = models.DateTimeField(auto_now=True)
    Every time record is saved the last modified date will update
    is_active = models.BooleanField(default=True)
```

| Option        | Meaning                 |
| ------------- | ----------------------- |
| `null=True`   | Allows NULL in DB       |
| `blank=True`  | Field optional in forms |
| `default`     | Default value           |
| `unique=True` | No duplicates allowed   |
| `choices=`    | Dropdown values         |

Example with choices:

```python
STATUS_CHOICES = [
    ('A', 'Active'),
    ('I', 'Inactive'),
]

status = models.CharField(max_length=1, choices=STATUS_CHOICES)
```

---

 üîç 3Ô∏è‚É£ Queries (ORM ‚Äì Object Relational Mapping)

Django uses ORM instead of writing SQL.

### üîπ Create

```python
Student.objects.create(name="Ravi", email="ravi@mail.com", age=22)
```

### üîπ Retrieve

```python
Student.objects.all() return all records
Student.objects.get(id=1) get specific records
Student.objects.filter(age=22) filtering selected record  #single condition
Student.objects.filter(Place="Tirupur",age__lt=17)
Student.objects.exclude(age=22) omitting the specific fields
comparison operators:
Greater than       age__gt=22
less than          age__lt=40
Greater than or equal age__gte=35
Less than or equal age__lte=20





### üîπ Update

```python
student = Student.objects.get(id=1)
student.age = 23
student.save()
```
Student.objects.filter(id=1).update(age=23)


### üîπ Delete

```python
student = Student.objects.get(id=1)
student.delete()
```

### üîπ Useful Query Filters

```python
Student.objects.filter(name__icontains="ra")
Student.objects.filter(age__gt=20)
Student.objects.order_by('-age')#descending order
Student.objects.order_by('age')#ascending order
Student.objects.count()
```

---

üîó 4Ô∏è‚É£ Accessing Related Objects (Relationships)

### üîπ ForeignKey (Many-to-One)

```python
class Department(models.Model):
    name = models.CharField(max_length=100)

class Employee(models.Model):
    name = models.CharField(max_length=100)
    department = models.ForeignKey(Department, on_delete=models.CASCADE)
```

Accessing relations:
primary key:
that uniquely identifies each record in the table
No duplicates
cannot be NULL

Foriegn key:
Field in one table that links to the primary key of another table

One to one     one record ->one record
many to one    many records -> one record
many to many   many records-> many records
```python
emp = Employee.objects.get(id=1)
print(emp.department.name)   # Forward relation (child to parent)

dept = Department.objects.get(id=1)
dept.employee_set.all()      # Reverse relation (parent-child)
```

---

### üîπ ManyToMany

```python
class Project(models.Model):
    name = models.CharField(max_length=100)

class Developer(models.Model):
    name = models.CharField(max_length=100)
    projects = models.ManyToManyField(Project)
```

```python
dev = Developer.objects.get(id=1)
dev.projects.all()
```

---

### üîπ OneToOne

```python
class Profile(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    #if profile got deleted user should also got deleted
    bio = models.TextField()
```

---

# üîÑ 5Ô∏è‚É£ Django Migrations

Migrations track model changes and update DB.

### Commands:

```bash
python manage.py makemigrations   # Create migration file
python manage.py migrate          # Apply to database
```

See SQL:

```bash
python manage.py sqlmigrate appname 0001
```

Migration files are stored in:
üìÅ `app_name/migrations/`

---

# 6Ô∏è‚É£ Database Transactions

A transaction is a group of database operations that run as one unit
Transactions ensure data safety & consistency (All or Nothing).
either all succeed
all fail(rollback)
### üîπ Using `atomic()`
@transaction.atomic
  It ensures all DB operations inside it succeed together
  If any error happens.both updates are rolled back

```python
from django.db import transaction

def transfer_money(sender, receiver, amount):
    with transaction.atomic():
        sender.balance -= amount
        sender.save()

        receiver.balance += amount
        receiver.save()
```

If any error occurs ‚Üí **both operations rollback**.

---

### üîπ Manual Rollback

```python
from django.db import transaction

@transaction.atomic
def create_order():
    order = Order.objects.create(...)
    if payment_failed:
        raise Exception("Payment failed")  # Rolls back
```

---

# üéØ Interview Quick Recap

| Topic         | Key Point                     |
| ------------- | ----------------------------- |
| Model         | Python class ‚Üí DB table       |
| Field Types   | Define data type & validation |
| ORM Queries   | CRUD without SQL              |
| Relationships | FK, M2M, OneToOne             |
| Migrations    | Sync models with DB           |
| Transactions  | Prevent partial data save     |



